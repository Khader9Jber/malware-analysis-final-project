# Malware Analysis Final Project for Computer Security Course

- Title: Final Project - Computer Security (Malware Analysis)
- Investigator: Khader J. K. Karaja
- Date: 25/4/2022-30/4/2022

---

## Analysis Summary:

```

```

---

1. Basic Static Analysis

   1.1 File Properties:

   ```
   - Filename:  2
   - File size: 121 KB
   - File type: File
   ```

   1.2 Hashes:

   ```
   - md5:       0468127a19daf4c7bc41015c5640fe1f
   - sha1:      133877dd043578a2e9cbe1a4bf60259894288afa
   - sha256:    dd1792bcdf560ebaa633f72de4037e78fe1ada5c8694b9d4879554aedc323ac9
   - Fuzzy:     3072:5HYBf8YzKw/MHfBTU3eiu0B/qIbmuvFT8whrQnFW:5HY70Bou0B/q6IOrQnFW
   ```

   1.3 [VirusTotal](https://www.virustotal.com/gui/file/dd1792bcdf560ebaa633f72de4037e78fe1ada5c8694b9d4879554aedc323ac9)

   - DETECTION section

   ```
   - 52/70 security vendors and 2 sandbox flagged this file as malicious
   - The most categorization for this file as **Trojan**
   ```

   - DETAILS section

   ```

   ```

   - RELATIONS section

   ```

   ```

   - BEHAVIOR section

   ```

   ```

   1.4 Code related observations (Obfuscation, Encryption, Packing, Reflection, Native Code, etc...)

   ```
   - The file did not compressed or encrypted.
   - It is made by Microsoft Visual C++ v.14 - 2019 ( E8 )
   ```

   1.5 Actual File Types

   ```
   - This file is an Executable (GUI) Binary File for Windows 32-bit
   - It works on Intel 80386 Processors
   ```

   1.6 Suspicious [Strings](./1_Basic_Static/6_strings/str.txt)

   > Maybe this program makes the machine work as a Botnet at a specific time.

   ```
   Sunday
   Monday
   Tuesday
   Wednesday
   Thursday
   Friday
   Saturday
   January
   February
   March
   April
   June
   July
   August
   September
   October
   November
   December
   MM/dd/yy
   dddd, MMMM dd, yyyy
   HH:mm:ss
   ```

   > Simple obfuscation technique
   >
   > > puts all chars in an array of chars or strings and access them by index

   ```
   !"#$%&'()*+,-./0123456789:;<=>?@abcdefghijklmnopqrstuvwxyz[\]^_`abcdefghijklmnopqrstuvwxyz{|}~
   !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~
   ```

   > Math Functions
   >
   > > This program can pretend to be a calculator

   ```
   log10
   lzZ?
   log10
   asin
   acos
   sqrt
   i9+=
   sinh
   cosh
   tanh
   atan
   atan2
   ceil
   floor
   fabs
   modf
   ldexp
   fmod
   frexp
   ```

   > Functions that deal with files (CreateFileW,...), processes and threads (GetCurrentProcessId, GetCurrentThreadIdÙˆ...)
   >
   > > There are suspicious functions that run code or other processes such as (LoadLibraryA, GetProcAddress, LoadLibraryExW,...), In addition to some DLLs names (KERNEL32.dll => semi normal , USER32.dll => GUI display and graphics), and Dealing with CLI (GetCommandLineA, GetCommandLineW, WriteConsoleW)

   ```
   !This program cannot be run in DOS mode.

   FlsAlloc
   FlsFree
   FlsGetValue
   FlsSetValue
   InitializeCriticalSectionEx
   CorExitProcess
   LCMapStringEx
   LocaleNameToLCID
   AppPolicyGetProcessTerminationMethod

   LoadLibraryA
   CloseHandle
   HeapAlloc
   GetProcAddress
   GetProcessHeap
   GetModuleHandleA
   IsValidCodePage
   GetLastError
   ExitProcess
   GetModuleHandleW
   KERNEL32.dll
   TranslateMessage
   DispatchMessageW
   GetMessageW
   USER32.dll
   UnhandledExceptionFilter
   SetUnhandledExceptionFilter
   GetCurrentProcess
   TerminateProcess
   IsProcessorFeaturePresent
   QueryPerformanceCounter
   GetCurrentProcessId
   GetCurrentThreadId
   GetSystemTimeAsFileTime
   InitializeSListHead
   IsDebuggerPresent
   GetStartupInfoW
   RtlUnwind
   SetLastError
   EnterCriticalSection
   LeaveCriticalSection
   DeleteCriticalSection
   InitializeCriticalSectionAndSpinCount
   TlsAlloc
   TlsGetValue
   TlsSetValue
   TlsFree
   FreeLibrary
   LoadLibraryExW
   RaiseException
   GetStdHandle
   WriteFile
   GetModuleFileNameW
   GetModuleHandleExW
   HeapFree
   FindClose
   FindFirstFileExW
   FindNextFileW
   GetACP
   GetOEMCP
   GetCPInfo
   GetCommandLineA
   GetCommandLineW
   MultiByteToWideChar
   WideCharToMultiByte
   GetEnvironmentStringsW
   FreeEnvironmentStringsW
   SetStdHandle
   GetFileType
   GetStringTypeW
   LCMapStringW
   HeapSize
   HeapReAlloc
   FlushFileBuffers
   GetConsoleCP
   GetConsoleMode
   SetFilePointerEx
   CreateFileW
   WriteConsoleW
   DecodePointer
   ```

   > XML Annotations
   >
   > > Sub Title

   ```
   <?xml version='1.0' encoding='UTF-8' standalone='yes'?>
   <assembly xmlns='urn:schemas-microsoft-com:asm.v1' manifestVersion='1.0'>
   <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
      <security>
         <requestedPrivileges>
         <requestedExecutionLevel level='asInvoker' uiAccess='false' />
         </requestedPrivileges>
      </security>
   </trustInfo>
   </assembly>
   ```

   > Suspicious Links, Emails and Addresses
   >
   > > Sub Title

   ```
   California1
   Mountain View1
   Mozilla Corporation1
   Release Engineering1
   release+certificates@mozilla.com
   www.digicert.com
   http://ocsp.digicert.com
   http://cacerts.digicert.com/DigiCertAssuredIDRootCA.crt0
   http://crl4.digicert.com/DigiCertAssuredIDRootCA.crl
   http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl
   https://www.digicert.com/CPS0
   http://crl3.digicert.com/sha2-assured-cs-g1.crl05
   http://crl4.digicert.com/sha2-assured-cs-g1.crl0L
   http://ocsp.digicert.com0N
   Bhttp://cacerts.digicert.com/DigiCertSHA2AssuredIDCodeSigningCA.crt0
   http://crl3.digicert.com/DigiCertAssuredIDRootCA.crl0:
   http://crl4.digicert.com/DigiCertAssuredIDRootCA.crl0
   crl3.digicert.com/DigiCertAssuredIDCA-1.crl08
   http://crl4.digicert.com/DigiCertAssuredIDCA-1.crl0w
   https://mozilla.org
   ```

---

1. Basic Dynamic analysis

---

3. Advanced Static Analysis (Code analysis)

---

4. Advanced Dynamic Analysis (Memory analysis)
